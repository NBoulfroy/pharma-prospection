function Ajax(a=null,b,c,d,e,f,g=null,h=null){this.modal=a,this.form=b,this.method=c,this.url=d,this.data=e,this.dataClass=f,this.type=g,this.link=h,this._query()}Ajax.prototype._createRequest=function(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject('Msxm12.XMLHTTP')?new ActiveXObject('Msxml2.XMLHTTP'):new ActiveXObject('Microsoft.XMLHTTP')},Ajax.prototype._displayMessageOnProgress=function(a){a.setAttribute('class','alert alert-dismissible alert-warning text-center');let b=document.createElement('button');b.setAttribute('type','button'),b.setAttribute('class','close'),b.setAttribute('data-dismiss','alert'),b.innerHTML='&times;',a.appendChild(b);let c=document.createElement('span');c.setAttribute('class','font-weight-bold'),c.innerHTML='Success:',a.appendChild(c),a.insertAdjacentText('beforeend',' your new expense account is being added.')},Ajax.prototype._displayMessageSuccess=function(a){a.setAttribute('class','alert alert-dismissible alert-success text-center');let b=document.createElement('button');b.setAttribute('type','button'),b.setAttribute('class','close'),b.setAttribute('data-dismiss','alert'),b.innerHTML='&times;',a.appendChild(b);let c=document.createElement('span');c.setAttribute('class','font-weight-bold'),c.innerHTML='Success:',a.appendChild(c),a.insertAdjacentText('beforeend',' your new expense account has been added successfully.')},Ajax.prototype._displayMessageError=function(a){a.setAttribute('class','alert alert-dismissible alert-danger text-center');let b=document.createElement('button');b.setAttribute('type','button'),b.setAttribute('class','close'),b.setAttribute('data-dismiss','alert'),b.innerHTML='&times;',a.appendChild(b);let c=document.createElement('span');c.setAttribute('class','font-weight-bold'),c.innerHTML='Error:',a.appendChild(c),a.insertAdjacentText('beforeend',' an error has occurred. If this happens again, contact the support.')},Ajax.prototype._displayMessage=function(a){let b=document.getElementsByClassName('message')[0];b.innerHTML='';let c=document.createElement('div');return'success'===a?(document.getElementsByClassName('emptyData')[0]?document.getElementsByClassName('emptyData')[0].innerHTML='':null,Ajax.prototype._displayMessageSuccess(c),b.appendChild(c)):'progress'===a?(document.getElementsByClassName('emptyData')[0]?document.getElementsByClassName('emptyData')[0].innerHTML='':null,Ajax.prototype._displayMessageOnProgress(c),b.append(c)):'error'===a?(Ajax.prototype._displayMessageError(c),b.appendChild(c)):void 0,c},Ajax.prototype._displayTable=function(a,b,c){let d=document.createElement('tr');for(let g,f=0;f<c;f++)g=document.createElement('td'),g.innerHTML=b.data[f],d.appendChild(g);a[0].appendChild(d)},Ajax.prototype._displayTableDetail=function(a,b,c,d){let e=document.createElement('tr');for(let g,f=0;f<c;f++){if(g=document.createElement('td'),f<c-1)g.innerHTML=b.data[f];else{let h=document.createElement('a'),k=d+'/'+b.data[f];h.setAttribute('href',k),h.setAttribute('class','btn btn-primary'),h.innerHTML='Details',g.appendChild(h)}e.appendChild(g)}a[0].appendChild(e)},Ajax.prototype._displayTableDetailPrint=function(a,b,c,d){let e=document.createElement('tr');for(let g,f=0;f<c;f++){if(g=document.createElement('td'),f<c-1)g.innerHTML=b.data[f];else for(let h=0;h<d.length;h++){let k=document.createElement('a'),l=d[h]+'/'+b.data[f];k.setAttribute('href',l),k.setAttribute('class','btn btn-primary'),k.innerHTML=0===h?'Details':'Print',g.insertAdjacentText('beforeend','\n'),g.appendChild(k)}e.appendChild(g)}a[0].appendChild(e)},Ajax.prototype._displayTableDelete=function(a,b,c,d){let e=document.createElement('tr');for(let g,f=0;f<c;f++){if(g=document.createElement('td'),!(f<c-2)){let h=document.createElement('a'),k=d+'/'+b.data[f];f++,k+='/'+b.data[f],h.setAttribute('href',k),h.setAttribute('class','btn btn-primary'),h.innerHTML='Delete',g.appendChild(h)}else if(f<c-2&&/^\/[a-zA-Z0-9]{1,}\/[a-zA-Z0-9]{1,}\/[a-zA-Z0-9]{1,}\.(jpg|jpeg|png)$/g.test(b.data[f])){let h=document.createElement('a');h.setAttribute('href',b.data[f]),h.setAttribute('target','_blank'),h.innerHTML='voucher',g.appendChild(h)}else g.innerHTML=b.data[f];e.appendChild(g)}a[0].appendChild(e)},Ajax.prototype._displayTableDeleteUpdate=function(a,b,c,d){let e=document.createElement('tr');for(let h,g=0;g<c-1;g++){if(h=document.createElement('td'),!(g<c-3)){let k=document.createElement('a'),l=d+'/'+b.data[g];g++,l+='/'+b.data[g],k.setAttribute('href',l),k.setAttribute('class','btn btn-primary'),k.innerHTML='Delete',h.appendChild(k)}else if(g<c-3&&/^\/[a-zA-Z0-9]{1,}\/[a-zA-Z0-9]{1,}\/[a-zA-Z0-9]{1,}\.(jpg|jpeg|png)$/g.test(b.data[g])){let k=document.createElement('a');k.setAttribute('href',b.data[g]),k.setAttribute('target','_blank'),k.innerHTML='voucher',h.appendChild(k)}else h.innerHTML=b.data[g];e.appendChild(h)}a[0].appendChild(e);let f=parseFloat(a[1].getElementsByTagName('input')[0].value);a[1].getElementsByTagName('input')[0].value=parseFloat(f)+parseFloat(b.data[c-1])},Ajax.prototype._displayResponse=function(a,b,c,d){let e=b.data.length;switch(c){default:Ajax.prototype._displayTable(a,b,e);break;case'tableDetail':Ajax.prototype._displayTableDetail(a,b,e,d);break;case'tableDetailPrint':Ajax.prototype._displayTableDetailPrint(a,b,e,d);break;case'tableDelete':Ajax.prototype._displayTableDelete(a,b,e,d);break;case'tableDeleteUpdate':Ajax.prototype._displayTableDeleteUpdate(a,b,e,d);}},Ajax.prototype._displayGoodData=function(a){for(let b=0;b<a.getElementsByTagName('input').length-1;b++)a.getElementsByTagName('input')[b].style.borderColor='#d3d3d3'},Ajax.prototype._displayWrongData=function(a){for(let b=0;b<a.getElementsByTagName('input').length-1;b++)a.getElementsByTagName('input')[b].style.borderColor='red'},Ajax.prototype._query=function(){let a=this._createRequest(),b=this.form,c=this.modal,d=this.method,e=this.url,f=this.data,g=this.dataClass,h=this.type,k=this.link;a.open(d,e),a.setRequestHeader('X-Requested-With','XMLHttpRequest'),a.send(f),a.onload=function(){if(200==a.status){let l=JSON.parse(a.responseText);'success'==l.status?(Ajax.prototype._displayGoodData(b),Ajax.prototype._displayResponse(g,l,h,k),Ajax.prototype._displayMessage('success')):Ajax.prototype._displayWrongData(b)}else Ajax.prototype._displayMessage('error');jQuery('#'+c).modal('toggle')}};